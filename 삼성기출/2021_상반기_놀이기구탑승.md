# [2021 상반기 삼성] 놀이기구 탑승

1. 성공

```protobuf
n=int(input())
arr=[]
for i in range(n*n):
    arr.append(list(map(int,input().split())))
dx=[1,-1,0,0]
dy=[0,0,-1,1]
board=[[-1]*n for _ in range(n)]
number=[]
for i in range(n*n):
    number.append(arr[i][0])

ans=0
def dfs(v,value,w,idx):
    maxv=0
    r,c=float('inf'),float('inf')
    if idx[0]==float('inf'):
        for i in range(n):
            for j in range(n):
                cnt=0
                for k in range(4):
                    nr,nc=i+dx[k],j+dy[k]
                    if 0<=nr<n and 0<=nc<n and v[nr][nc]==-1:
                        cnt+=1
                if cnt>maxv:
                   maxv=cnt
                   r,c=i,j
                elif cnt==maxv:
                    if i<r:
                        maxv=cnt
                        r,c=i,j
                    elif i==r:
                        if j<c:
                            maxv=cnt
                            r,c=i,j

    else:
        score=-float('inf')
        cnt=0
        for i in range(n):
            for j in range(n):
                if v[i][j]==-1:
                    cnt=0
                    left=0
                    for k in range(4):
                        nr,nc=i+dx[k],j+dy[k]
                        if 0<=nr<n and 0<=nc<n:
                            if v[nr][nc] in arr[w][1:]:
                                cnt+=1
                            else:
                                if v[nr][nc]==-1:
                                    left+=1
                    if cnt > maxv:
                        maxv = cnt
                        r, c = i, j
                        score=left
                    elif cnt == maxv:
                        if left>score:
                            maxv=cnt
                            r,c=i,j
                            score=left
                        elif left==score:
                            if i < r:
                                maxv = cnt
                                r, c = i, j
                                score=left
                            elif i == r:
                                if j < c:
                                    maxv = cnt
                                    r, c = i, j
                                    score=left

    v[r][c]=value
    return (v,[r,c])

idx=[float('inf'),float('inf')]
for i in range(n*n):
    tmp=board[:]
    board,idx=dfs(tmp,arr[i][0],i,idx)

for num,idx in enumerate(number):
    ck=False
  
    for i in range(n):
        for j in range(n):
            if board[i][j]==idx:
                cnt=0
                ck=True
                for k in range(4):
                    nr,nc=i+dx[k],j+dy[k]
                    if 0<=nr<n and 0<=nc<n:
                        if board[nr][nc] in arr[num][1:]:
             
                            cnt+=1
                if cnt==1:
                    ans+=1
                elif cnt==2:
                    ans+=10
                elif cnt==3:
                    ans+=100
                elif cnt==4:
                    ans+=1000
                break
        if ck:
            break

print(ans)
```